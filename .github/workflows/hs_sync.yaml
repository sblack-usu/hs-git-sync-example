name: Run Python script on changes in a folder

on:
  push:
    paths:
      - 'notebooks/**'

jobs:
  run-python:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: '3.x'

    - name: Sync Notebooks
      env:
        HYDROSHARE_USERNAME: ${{ env.HYDROSHARE_USERNAME }}
        HYDROSHARE_PASSWORD: ${{ secrets.HYDROSHARE_PASSWORD }}
        HYDROSHARE_RESOURCE_ID: ${{ env.HYDROSHARE_RESOURCE_ID }}
      run: |
        import os
        python -m pip install --upgrade pip
        pip install hsclient
        hs = HydroShare(username=$HYDROSHARE_USERNAME, password=$HYDROSHARE_PASSWORD)
        hs_res = hs.resource($HYDROSHARE_RESOURCE_ID)
        hs_res.file_upload(os.listdir('notebooks'), destination_path='notebooks')
